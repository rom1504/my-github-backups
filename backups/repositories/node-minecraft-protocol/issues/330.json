{
    "assignee": null,
    "body": "`createClient()` accepts a \"version\" option to specify a Minecraft release, which is used to lookup the dataset in [minecraft-data](https://github.com/PrismarineJS/minecraft-data) via [node-minecraft-data](https://github.com/PrismarineJS/node-minecraft-data) (translating it to a major version, but see https://github.com/PrismarineJS/node-minecraft-data/issues/13, e.g. 1.8.9 -> 1.8), in turn used to set the protocol version in the `set_protocol` packet handshake, limiting the multi-protocol support of NMP to one protocol per major release.\r\n\r\nThis PR adds another option `protocolVersion`, clients can use to specify the exact protocol version to use. Data will still be used from minecraft-data based on `version`, but since `version`/minecraft-data specifies a major release, this additional `protocolVersion` option will allow clients to use minor \"sub-versions\" within the major version.\r\n\r\n---\r\n\r\n(Note: the client app is on their own when it comes to handling minor version discrepancies. 15w40b/76 for example is not compatible with 16w03a/96 because they renumbered all the packets. minecraft-data will probably just support one snapshot version at a time, the latest since it was updated. But `protocolVersion` would still be useful for smaller protocol updates where packets are added/removed but mostly compatible otherwise.)",
    "closed_at": "2016-01-26T07:06:38Z",
    "comment_data": [
        {
            "body": "I'm not sure I agree with this. Anything can occur within a proto version bump. If someone wants to do this, he can fork mc-data and edit the default protocolVersion. I don't think we should make it easier than that.",
            "created_at": "2016-01-25T03:13:44Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/pull/330#issuecomment-174382889",
            "id": 174382889,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/330",
            "updated_at": "2016-01-25T03:13:44Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/174382889",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1069318?v=3",
                "events_url": "https://api.github.com/users/roblabla/events{/privacy}",
                "followers_url": "https://api.github.com/users/roblabla/followers",
                "following_url": "https://api.github.com/users/roblabla/following{/other_user}",
                "gists_url": "https://api.github.com/users/roblabla/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/roblabla",
                "id": 1069318,
                "login": "roblabla",
                "organizations_url": "https://api.github.com/users/roblabla/orgs",
                "received_events_url": "https://api.github.com/users/roblabla/received_events",
                "repos_url": "https://api.github.com/users/roblabla/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/roblabla/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/roblabla/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/roblabla"
            }
        },
        {
            "body": "Note that we could support snapshots in mc-data by naming them by their snapshot them, e.g. 15w40b, and passing that \"version\" to NMP instead, instead of putting the \"fake\" 1.9.\r\n\r\nI believe that is a better, cleaner path forward.",
            "created_at": "2016-01-25T03:15:25Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/pull/330#issuecomment-174383041",
            "id": 174383041,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/330",
            "updated_at": "2016-01-25T03:15:36Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/174383041",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1069318?v=3",
                "events_url": "https://api.github.com/users/roblabla/events{/privacy}",
                "followers_url": "https://api.github.com/users/roblabla/followers",
                "following_url": "https://api.github.com/users/roblabla/following{/other_user}",
                "gists_url": "https://api.github.com/users/roblabla/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/roblabla",
                "id": 1069318,
                "login": "roblabla",
                "organizations_url": "https://api.github.com/users/roblabla/orgs",
                "received_events_url": "https://api.github.com/users/roblabla/received_events",
                "repos_url": "https://api.github.com/users/roblabla/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/roblabla/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/roblabla/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/roblabla"
            }
        },
        {
            "body": "Oh I released mcdata 0.18.0 providing `mcdata.versionsByMinecraftVersion` except I forgot I have to use it in the loader too. I guess I'll do that later.\r\n\r\n> Note that we could support snapshots in mc-data by naming them by their snapshot them, e.g. 15w40b, and passing that \"version\" to NMP instead, instead of putting the \"fake\" 1.9.\r\n\r\nYes that is definitely possible with the new versions data in mcdata. (Both passing 1.8 and 1.8.8 could be supported that way). I'll add support for that in node-minecraft-data.",
            "created_at": "2016-01-25T20:43:06Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/pull/330#issuecomment-174656603",
            "id": 174656603,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/330",
            "updated_at": "2016-01-25T20:43:06Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/174656603",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2346494?v=3",
                "events_url": "https://api.github.com/users/rom1504/events{/privacy}",
                "followers_url": "https://api.github.com/users/rom1504/followers",
                "following_url": "https://api.github.com/users/rom1504/following{/other_user}",
                "gists_url": "https://api.github.com/users/rom1504/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rom1504",
                "id": 2346494,
                "login": "rom1504",
                "organizations_url": "https://api.github.com/users/rom1504/orgs",
                "received_events_url": "https://api.github.com/users/rom1504/received_events",
                "repos_url": "https://api.github.com/users/rom1504/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rom1504/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rom1504/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rom1504"
            }
        },
        {
            "body": "Yeah this is not really a good solution. Now that minecraft-data has protocolVersions I think using it is the right solution going forward. I guess most of the changes will be in node-minecraft-data.\r\n\r\nBut some datasets in minecraft-data will support multiple protocol versions, right? If so I'd want to ensure the node-minecraft-protocol handshake uses the exact protocol version I give it (presuming it is supported). The use case here is nmp-auto / GH-331, where it pings the server to get the precise protocol version to use, then uses it in the handshake. If the protocol version does not match exactly the server will refuse the connection so it's important to have this level of control, in some form.",
            "created_at": "2016-01-26T02:45:51Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/pull/330#issuecomment-174787348",
            "id": 174787348,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/330",
            "updated_at": "2016-01-26T02:45:51Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/174787348",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5897956?v=3",
                "events_url": "https://api.github.com/users/deathcap/events{/privacy}",
                "followers_url": "https://api.github.com/users/deathcap/followers",
                "following_url": "https://api.github.com/users/deathcap/following{/other_user}",
                "gists_url": "https://api.github.com/users/deathcap/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/deathcap",
                "id": 5897956,
                "login": "deathcap",
                "organizations_url": "https://api.github.com/users/deathcap/orgs",
                "received_events_url": "https://api.github.com/users/deathcap/received_events",
                "repos_url": "https://api.github.com/users/deathcap/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/deathcap/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/deathcap/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/deathcap"
            }
        },
        {
            "body": "I thing this is (again) another use-case for the modules. I'd imagine substituting the \"handshake\" module with a slightly modified one that sends the protocol version you want would be more appropriate. \r\n\r\nThe thing is, with the monolithic and huge createClient, we already have way too many options. Adding more options only useful in the 0.001% case to an already somewhat bloated API sucks.\r\n\r\nInstead, we should let the users redefine small parts of the big \"createClient\" function through some kind of module system, and have createClient just use some sane defaults.",
            "created_at": "2016-01-26T03:06:00Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/pull/330#issuecomment-174792916",
            "id": 174792916,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/330",
            "updated_at": "2016-01-26T03:06:00Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/174792916",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1069318?v=3",
                "events_url": "https://api.github.com/users/roblabla/events{/privacy}",
                "followers_url": "https://api.github.com/users/roblabla/followers",
                "following_url": "https://api.github.com/users/roblabla/following{/other_user}",
                "gists_url": "https://api.github.com/users/roblabla/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/roblabla",
                "id": 1069318,
                "login": "roblabla",
                "organizations_url": "https://api.github.com/users/roblabla/orgs",
                "received_events_url": "https://api.github.com/users/roblabla/received_events",
                "repos_url": "https://api.github.com/users/roblabla/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/roblabla/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/roblabla/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/roblabla"
            }
        },
        {
            "body": "Indeed, modularizing is becoming more compelling with the various new use cases (cross-version, Forge, auto-negotiation, websockets). I think ideally node-minecraft-protocol would mostly consist of small composable components for each piece of functionality. The minecraft-data/protodef refactor was a good start, also the compression/framing/serializer transforms, but much more would be possible with some judicious modularization. Relating https://github.com/PrismarineJS/node-minecraft-protocol/pull/210 NMP Modularization I'll put some more notes there in a few.\r\n\r\nAs for this issue, what it comes down to is minecraft-data supporting datasets, currently 1.8 and '1.9', with fixed version.json for each (protocol 47 and 76, respectively). Clients can specify a minor version but 1.8.9, 1.8.8, etc. will all get stripped down to 1.8. For 1.8.x this is not much of a problem since they're largely all 47. But this is not true in general. For example 1.6.1 and 1.6.2 have different protocols (73 and 74) even though they are both 1.6 major. Not that either are currently supported by minecraft-data but it could be a problem as new protocols are added. Translating the release versions to protocol versions through minecraft-data https://github.com/PrismarineJS/node-minecraft-data/issues/13 should help fix this (though the datasets in minecraft-data would also need appropriate support.).",
            "created_at": "2016-01-26T05:06:00Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/pull/330#issuecomment-174831671",
            "id": 174831671,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/330",
            "updated_at": "2016-01-26T05:06:00Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/174831671",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5897956?v=3",
                "events_url": "https://api.github.com/users/deathcap/events{/privacy}",
                "followers_url": "https://api.github.com/users/deathcap/followers",
                "following_url": "https://api.github.com/users/deathcap/following{/other_user}",
                "gists_url": "https://api.github.com/users/deathcap/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/deathcap",
                "id": 5897956,
                "login": "deathcap",
                "organizations_url": "https://api.github.com/users/deathcap/orgs",
                "received_events_url": "https://api.github.com/users/deathcap/received_events",
                "repos_url": "https://api.github.com/users/deathcap/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/deathcap/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/deathcap/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/deathcap"
            }
        },
        {
            "body": "Closing in favor of https://github.com/PrismarineJS/node-minecraft-data/issues/13 Update to use minecraft-data for toMajor()  and https://github.com/PrismarineJS/node-minecraft-data/issues/15 versionsByProtocolVersion index (although some fixes may be needed to NMP, can be handled separately if needed, not sure any are)",
            "created_at": "2016-01-26T07:06:38Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/pull/330#issuecomment-174864715",
            "id": 174864715,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/330",
            "updated_at": "2016-01-26T07:06:38Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/174864715",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5897956?v=3",
                "events_url": "https://api.github.com/users/deathcap/events{/privacy}",
                "followers_url": "https://api.github.com/users/deathcap/followers",
                "following_url": "https://api.github.com/users/deathcap/following{/other_user}",
                "gists_url": "https://api.github.com/users/deathcap/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/deathcap",
                "id": 5897956,
                "login": "deathcap",
                "organizations_url": "https://api.github.com/users/deathcap/orgs",
                "received_events_url": "https://api.github.com/users/deathcap/received_events",
                "repos_url": "https://api.github.com/users/deathcap/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/deathcap/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/deathcap/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/deathcap"
            }
        }
    ],
    "comments": 7,
    "comments_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/330/comments",
    "created_at": "2016-01-25T01:15:40Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5897956?v=3",
                "events_url": "https://api.github.com/users/deathcap/events{/privacy}",
                "followers_url": "https://api.github.com/users/deathcap/followers",
                "following_url": "https://api.github.com/users/deathcap/following{/other_user}",
                "gists_url": "https://api.github.com/users/deathcap/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/deathcap",
                "id": 5897956,
                "login": "deathcap",
                "organizations_url": "https://api.github.com/users/deathcap/orgs",
                "received_events_url": "https://api.github.com/users/deathcap/received_events",
                "repos_url": "https://api.github.com/users/deathcap/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/deathcap/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/deathcap/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/deathcap"
            },
            "commit_id": "4fb26510f9529e208ef29afb1683f8639819c1fa",
            "commit_url": "https://api.github.com/repos/deathcap/node-minecraft-protocol-auto/commits/4fb26510f9529e208ef29afb1683f8639819c1fa",
            "created_at": "2016-01-25T01:48:18Z",
            "event": "referenced",
            "id": 524443638,
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/events/524443638"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5897956?v=3",
                "events_url": "https://api.github.com/users/deathcap/events{/privacy}",
                "followers_url": "https://api.github.com/users/deathcap/followers",
                "following_url": "https://api.github.com/users/deathcap/following{/other_user}",
                "gists_url": "https://api.github.com/users/deathcap/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/deathcap",
                "id": 5897956,
                "login": "deathcap",
                "organizations_url": "https://api.github.com/users/deathcap/orgs",
                "received_events_url": "https://api.github.com/users/deathcap/received_events",
                "repos_url": "https://api.github.com/users/deathcap/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/deathcap/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/deathcap/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/deathcap"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2016-01-26T02:34:19Z",
            "event": "renamed",
            "id": 525897966,
            "rename": {
                "from": "Intra-release multi-protocol support",
                "to": "[WIP] Intra-release multi-protocol support"
            },
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/events/525897966"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5897956?v=3",
                "events_url": "https://api.github.com/users/deathcap/events{/privacy}",
                "followers_url": "https://api.github.com/users/deathcap/followers",
                "following_url": "https://api.github.com/users/deathcap/following{/other_user}",
                "gists_url": "https://api.github.com/users/deathcap/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/deathcap",
                "id": 5897956,
                "login": "deathcap",
                "organizations_url": "https://api.github.com/users/deathcap/orgs",
                "received_events_url": "https://api.github.com/users/deathcap/received_events",
                "repos_url": "https://api.github.com/users/deathcap/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/deathcap/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/deathcap/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/deathcap"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2016-01-26T07:06:38Z",
            "event": "closed",
            "id": 526080455,
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/events/526080455"
        }
    ],
    "events_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/330/events",
    "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/pull/330",
    "id": 128440465,
    "labels": [],
    "labels_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/330/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 330,
    "pull_request": {
        "diff_url": "https://github.com/PrismarineJS/node-minecraft-protocol/pull/330.diff",
        "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/pull/330",
        "patch_url": "https://github.com/PrismarineJS/node-minecraft-protocol/pull/330.patch",
        "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/pulls/330"
    },
    "state": "closed",
    "title": "[WIP] Intra-release multi-protocol support",
    "updated_at": "2016-01-26T07:06:38Z",
    "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/330",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/5897956?v=3",
        "events_url": "https://api.github.com/users/deathcap/events{/privacy}",
        "followers_url": "https://api.github.com/users/deathcap/followers",
        "following_url": "https://api.github.com/users/deathcap/following{/other_user}",
        "gists_url": "https://api.github.com/users/deathcap/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/deathcap",
        "id": 5897956,
        "login": "deathcap",
        "organizations_url": "https://api.github.com/users/deathcap/orgs",
        "received_events_url": "https://api.github.com/users/deathcap/received_events",
        "repos_url": "https://api.github.com/users/deathcap/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/deathcap/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/deathcap/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/deathcap"
    }
}