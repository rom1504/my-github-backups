{
    "assignee": null,
    "body": "Been looking at the code, and there's something bugging me still about the client : we still have a distinction between the username and the email in the login. To fix this issue 100%, we would need to move the call to getLoginSession before the creation of the client, and get the actual username from it.\r\nFor 1, it would remove the batch job (which I personally find quiet ugly, but that's just me).\r\nFor 2, it would be more logical (we shouldn't login to the minecraft server before connecting to a server)...\r\n\r\nOf course, getLoginSession would only be called if haveCredidentials is true.",
    "closed_at": "2013-01-31T01:04:51Z",
    "comment_data": [
        {
            "body": "I originally started to do it the way you are describing, but then when I took offline mode into account, I changed it to do it this way.\r\n\r\nWhat I realized was that if the server is in offline-mode, you might not have to do `getLoginSession`. In offline mode, `onEncryptionKeyRequest` is never called, and you must know your username.\r\n\r\nIn order to find out whether `onEncryptionKeyRequest` will be called, we have to make the connection to the server, which includes giving the server the username. Catch 22.\r\n\r\nRequiring the user to supply a username allows us to connect as fast as is possible while maintaining a simple API.\r\n\r\nThat being said, my mind is still open. If you want to change the way the API works, can you give code examples and explain exactly what it would do?",
            "created_at": "2013-01-30T00:28:38Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/32#issuecomment-12867160",
            "id": 12867160,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/32",
            "updated_at": "2013-01-30T00:28:38Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/12867160",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/106511?v=3",
                "events_url": "https://api.github.com/users/andrewrk/events{/privacy}",
                "followers_url": "https://api.github.com/users/andrewrk/followers",
                "following_url": "https://api.github.com/users/andrewrk/following{/other_user}",
                "gists_url": "https://api.github.com/users/andrewrk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/andrewrk",
                "id": 106511,
                "login": "andrewrk",
                "organizations_url": "https://api.github.com/users/andrewrk/orgs",
                "received_events_url": "https://api.github.com/users/andrewrk/received_events",
                "repos_url": "https://api.github.com/users/andrewrk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/andrewrk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/andrewrk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/andrewrk"
            }
        },
        {
            "body": "I feel like it should try to login to the minecraft login server no matter what, just like the real client. You could be able to specify if you want to use offline mode if you know it isn't a real Minecraft account. This means the flows could go something like this:\r\n\r\nUsing a real account:\r\n* Client is created using a minecraft.net username or email in the 'username' field\r\n* Client logs in to minecraft.net, gets a session and our username\r\n* Client connects to a server\r\n  * If it is in offline mode, handshake with our username\r\n  * If it is in online mode, handshake with our minecraft.net session\r\n\r\nOffline mode:\r\n* Client is created using some arbitrary value for the 'username' field, and 'offline' is true\r\n* Client connects to a server\r\n  * If it is in offline mode, handshake with the given username\r\n  * If it is in online mode, emit an error\r\n\r\nThis more closely mirrors how the client works, and would be a lot more intuitive.",
            "created_at": "2013-01-30T00:43:32Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/32#issuecomment-12867674",
            "id": 12867674,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/32",
            "updated_at": "2013-01-30T00:43:32Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/12867674",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/398285?v=3",
                "events_url": "https://api.github.com/users/mappum/events{/privacy}",
                "followers_url": "https://api.github.com/users/mappum/followers",
                "following_url": "https://api.github.com/users/mappum/following{/other_user}",
                "gists_url": "https://api.github.com/users/mappum/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mappum",
                "id": 398285,
                "login": "mappum",
                "organizations_url": "https://api.github.com/users/mappum/orgs",
                "received_events_url": "https://api.github.com/users/mappum/received_events",
                "repos_url": "https://api.github.com/users/mappum/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mappum/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mappum/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mappum"
            }
        },
        {
            "body": "I put some more thought into it and I think you guys are right. Here is what I have come up with:\r\n\r\n1. modify `createClient` - remove the `username` option. The library will figure it out for you by authenticating your email and password. This method of creating a client will succeed regardless of whether the server is in online mode or not. (But it will emit an error if your password is wrong)\r\n2. add `createOfflineClient` - this is like `createClient` but add a `username` option and remove the `email` and `password` options. It will emit an error if the server is in online mode.\r\n\r\nThoughts?",
            "created_at": "2013-01-30T01:04:33Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/32#issuecomment-12868355",
            "id": 12868355,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/32",
            "updated_at": "2013-01-30T01:06:28Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/12868355",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/106511?v=3",
                "events_url": "https://api.github.com/users/andrewrk/events{/privacy}",
                "followers_url": "https://api.github.com/users/andrewrk/followers",
                "following_url": "https://api.github.com/users/andrewrk/following{/other_user}",
                "gists_url": "https://api.github.com/users/andrewrk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/andrewrk",
                "id": 106511,
                "login": "andrewrk",
                "organizations_url": "https://api.github.com/users/andrewrk/orgs",
                "received_events_url": "https://api.github.com/users/andrewrk/received_events",
                "repos_url": "https://api.github.com/users/andrewrk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/andrewrk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/andrewrk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/andrewrk"
            }
        },
        {
            "body": "What about simply checking for a password instead of two different methods ? hasCredidentials is here. I think two functions is an overkill personally :/",
            "created_at": "2013-01-30T07:22:31Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/32#issuecomment-12877457",
            "id": 12877457,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/32",
            "updated_at": "2013-01-30T07:22:31Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/12877457",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1069318?v=3",
                "events_url": "https://api.github.com/users/roblabla/events{/privacy}",
                "followers_url": "https://api.github.com/users/roblabla/followers",
                "following_url": "https://api.github.com/users/roblabla/following{/other_user}",
                "gists_url": "https://api.github.com/users/roblabla/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/roblabla",
                "id": 1069318,
                "login": "roblabla",
                "organizations_url": "https://api.github.com/users/roblabla/orgs",
                "received_events_url": "https://api.github.com/users/roblabla/received_events",
                "repos_url": "https://api.github.com/users/roblabla/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/roblabla/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/roblabla/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/roblabla"
            }
        },
        {
            "body": "@roblabla good point, that would work well.\r\n\r\nAnd I think the property should be `username` because that is the label on the real client.",
            "created_at": "2013-01-30T07:28:07Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/32#issuecomment-12877591",
            "id": 12877591,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/32",
            "updated_at": "2013-01-30T07:28:07Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/12877591",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/398285?v=3",
                "events_url": "https://api.github.com/users/mappum/events{/privacy}",
                "followers_url": "https://api.github.com/users/mappum/followers",
                "following_url": "https://api.github.com/users/mappum/following{/other_user}",
                "gists_url": "https://api.github.com/users/mappum/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mappum",
                "id": 398285,
                "login": "mappum",
                "organizations_url": "https://api.github.com/users/mappum/orgs",
                "received_events_url": "https://api.github.com/users/mappum/received_events",
                "repos_url": "https://api.github.com/users/mappum/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mappum/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mappum/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mappum"
            }
        },
        {
            "body": "OK I'm convinced. Implementing the changes.",
            "created_at": "2013-01-30T16:32:04Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/32#issuecomment-12898257",
            "id": 12898257,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/32",
            "updated_at": "2013-01-30T16:32:04Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/12898257",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/106511?v=3",
                "events_url": "https://api.github.com/users/andrewrk/events{/privacy}",
                "followers_url": "https://api.github.com/users/andrewrk/followers",
                "following_url": "https://api.github.com/users/andrewrk/following{/other_user}",
                "gists_url": "https://api.github.com/users/andrewrk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/andrewrk",
                "id": 106511,
                "login": "andrewrk",
                "organizations_url": "https://api.github.com/users/andrewrk/orgs",
                "received_events_url": "https://api.github.com/users/andrewrk/received_events",
                "repos_url": "https://api.github.com/users/andrewrk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/andrewrk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/andrewrk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/andrewrk"
            }
        },
        {
            "body": "landed in 0.7.0",
            "created_at": "2013-01-31T01:05:29Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/32#issuecomment-12922048",
            "id": 12922048,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/32",
            "updated_at": "2013-01-31T01:05:29Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/12922048",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/106511?v=3",
                "events_url": "https://api.github.com/users/andrewrk/events{/privacy}",
                "followers_url": "https://api.github.com/users/andrewrk/followers",
                "following_url": "https://api.github.com/users/andrewrk/following{/other_user}",
                "gists_url": "https://api.github.com/users/andrewrk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/andrewrk",
                "id": 106511,
                "login": "andrewrk",
                "organizations_url": "https://api.github.com/users/andrewrk/orgs",
                "received_events_url": "https://api.github.com/users/andrewrk/received_events",
                "repos_url": "https://api.github.com/users/andrewrk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/andrewrk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/andrewrk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/andrewrk"
            }
        }
    ],
    "comments": 7,
    "comments_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/32/comments",
    "created_at": "2013-01-29T23:40:45Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1069318?v=3",
                "events_url": "https://api.github.com/users/roblabla/events{/privacy}",
                "followers_url": "https://api.github.com/users/roblabla/followers",
                "following_url": "https://api.github.com/users/roblabla/following{/other_user}",
                "gists_url": "https://api.github.com/users/roblabla/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/roblabla",
                "id": 1069318,
                "login": "roblabla",
                "organizations_url": "https://api.github.com/users/roblabla/orgs",
                "received_events_url": "https://api.github.com/users/roblabla/received_events",
                "repos_url": "https://api.github.com/users/roblabla/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/roblabla/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/roblabla/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/roblabla"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2013-01-30T07:28:07Z",
            "event": "mentioned",
            "id": 36071551,
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/events/36071551"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1069318?v=3",
                "events_url": "https://api.github.com/users/roblabla/events{/privacy}",
                "followers_url": "https://api.github.com/users/roblabla/followers",
                "following_url": "https://api.github.com/users/roblabla/following{/other_user}",
                "gists_url": "https://api.github.com/users/roblabla/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/roblabla",
                "id": 1069318,
                "login": "roblabla",
                "organizations_url": "https://api.github.com/users/roblabla/orgs",
                "received_events_url": "https://api.github.com/users/roblabla/received_events",
                "repos_url": "https://api.github.com/users/roblabla/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/roblabla/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/roblabla/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/roblabla"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2013-01-30T07:28:07Z",
            "event": "subscribed",
            "id": 36071552,
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/events/36071552"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/106511?v=3",
                "events_url": "https://api.github.com/users/andrewrk/events{/privacy}",
                "followers_url": "https://api.github.com/users/andrewrk/followers",
                "following_url": "https://api.github.com/users/andrewrk/following{/other_user}",
                "gists_url": "https://api.github.com/users/andrewrk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/andrewrk",
                "id": 106511,
                "login": "andrewrk",
                "organizations_url": "https://api.github.com/users/andrewrk/orgs",
                "received_events_url": "https://api.github.com/users/andrewrk/received_events",
                "repos_url": "https://api.github.com/users/andrewrk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/andrewrk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/andrewrk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/andrewrk"
            },
            "commit_id": "df3f95e1ff122a29a3aa65f75e8f40a6bd1d3948",
            "commit_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/commits/df3f95e1ff122a29a3aa65f75e8f40a6bd1d3948",
            "created_at": "2013-01-31T01:04:51Z",
            "event": "closed",
            "id": 36197666,
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/events/36197666"
        }
    ],
    "events_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/32/events",
    "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/32",
    "id": 10439631,
    "labels": [],
    "labels_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/32/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 32,
    "repository_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol",
    "state": "closed",
    "title": "client : username/email -> login",
    "updated_at": "2013-01-31T01:05:29Z",
    "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/32",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1069318?v=3",
        "events_url": "https://api.github.com/users/roblabla/events{/privacy}",
        "followers_url": "https://api.github.com/users/roblabla/followers",
        "following_url": "https://api.github.com/users/roblabla/following{/other_user}",
        "gists_url": "https://api.github.com/users/roblabla/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/roblabla",
        "id": 1069318,
        "login": "roblabla",
        "organizations_url": "https://api.github.com/users/roblabla/orgs",
        "received_events_url": "https://api.github.com/users/roblabla/received_events",
        "repos_url": "https://api.github.com/users/roblabla/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/roblabla/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/roblabla/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/roblabla"
    }
}