{
    "assignee": null,
    "body": "Those two are the last datatypes that are very minecraft-specific, and could, with a bit of magic, be generalized. The problem is, they both need a new datatype.\r\n\r\n- Slot requires some kind of `peek` dataType, that acts like switch, but compares to a value in the stream without consuming it.\r\n- EntityMetadata requires some kind of `loop` dataType.",
    "closed_at": "2015-11-19T14:13:35Z",
    "comment_data": [
        {
            "body": "what about uuid ?",
            "created_at": "2015-08-27T15:29:26Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/225#issuecomment-135469612",
            "id": 135469612,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/225",
            "updated_at": "2015-08-27T15:29:26Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/135469612",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2346494?v=3",
                "events_url": "https://api.github.com/users/rom1504/events{/privacy}",
                "followers_url": "https://api.github.com/users/rom1504/followers",
                "following_url": "https://api.github.com/users/rom1504/following{/other_user}",
                "gists_url": "https://api.github.com/users/rom1504/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rom1504",
                "id": 2346494,
                "login": "rom1504",
                "organizations_url": "https://api.github.com/users/rom1504/orgs",
                "received_events_url": "https://api.github.com/users/rom1504/received_events",
                "repos_url": "https://api.github.com/users/rom1504/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rom1504/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rom1504/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rom1504"
            }
        },
        {
            "body": "UUID is read as 4 ints, and then stringified into a dashed hex. I hardly see how we could ever represent that in the protocol ^^'.",
            "created_at": "2015-08-27T17:17:12Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/225#issuecomment-135496717",
            "id": 135496717,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/225",
            "updated_at": "2015-08-27T17:17:12Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/135496717",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1069318?v=3",
                "events_url": "https://api.github.com/users/roblabla/events{/privacy}",
                "followers_url": "https://api.github.com/users/roblabla/followers",
                "following_url": "https://api.github.com/users/roblabla/following{/other_user}",
                "gists_url": "https://api.github.com/users/roblabla/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/roblabla",
                "id": 1069318,
                "login": "roblabla",
                "organizations_url": "https://api.github.com/users/roblabla/orgs",
                "received_events_url": "https://api.github.com/users/roblabla/received_events",
                "repos_url": "https://api.github.com/users/roblabla/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/roblabla/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/roblabla/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/roblabla"
            }
        },
        {
            "body": "hmm, maybe it's standard enough to be not minecraft specific though ?\r\nsince it follows a rfc and all https://github.com/broofa/node-uuid\r\n\r\nmaybe it should just be in a uuid.js , and it could just be included in Protocols ?",
            "created_at": "2015-08-27T17:56:31Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/225#issuecomment-135506898",
            "id": 135506898,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/225",
            "updated_at": "2015-08-27T18:00:10Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/135506898",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2346494?v=3",
                "events_url": "https://api.github.com/users/rom1504/events{/privacy}",
                "followers_url": "https://api.github.com/users/rom1504/followers",
                "following_url": "https://api.github.com/users/rom1504/following{/other_user}",
                "gists_url": "https://api.github.com/users/rom1504/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rom1504",
                "id": 2346494,
                "login": "rom1504",
                "organizations_url": "https://api.github.com/users/rom1504/orgs",
                "received_events_url": "https://api.github.com/users/rom1504/received_events",
                "repos_url": "https://api.github.com/users/rom1504/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rom1504/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rom1504/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rom1504"
            }
        },
        {
            "body": "From @roblabla : \r\n```js\r\nfunction readEntityMetadata(buffer, offset, typeArgs, context) {\r\n  var cursor = offset;\r\n  var metadata = [];\r\n  var item, key, type, results, reader, typeName, dataType;\r\n  while(true) {\r\n    item = buffer.readUInt8(cursor);\r\n    if(item === typeArgs.endVal) {\r\n      return {\r\n        value: metadata,\r\n        size: cursor - offset,\r\n      };\r\n    }\r\n    results = this.read(buffer, cursor, \"entityMetadataKeyType\");\r\n    cursor += results.size;\r\n    ({ key, type } = results.value);\r\n    var results = this.read(buffer, cursor, [\"entityMetadataItem\", { \"compareTo\": \"type\" }], { type });\r\n    metadata.push({\r\n      key,\r\n      type,\r\n      value: results.value,\r\n    });\r\n    cursor += results.size;\r\n  }\r\n}\r\n```\r\n```json\r\n \"entityMetadata\": [\"entityMetadataLoop\", { \"val\": 256 }],\r\n\"entityMetadataKeyType\": [\"bittrick\"],\r\n\"entityMetadataItem: \"we already have that\"\r\n```\r\nand entityMetadataLoop is the native type\r\nthis is the flexible cross-version way\r\nso we can change every part of the algorithm without issue\r\n\r\n```json\r\n\"position\": [\"bittrick\", [\r\n  { \"name\": \"x\", \"size\": 26 },\r\n  { \"name\": \"y\", \"size\": 12 },\r\n  { \"name\": \"z\", \"size\": 26 }\r\n]]\r\n```\r\n\r\n```json\r\n\"entityMetadataKeyType\": [\"bitfields\", [\r\n  { \"name\": \"type\", \"size\": 3 },\r\n  { \"name\": \"key\", \"size\": 5 }\r\n]]\r\n```\r\nI think\r\nand for 1.9\r\n```json\r\n \"entityMetadataKeyType\": [\"container\", [\r\n  { \"name\": \"key\", \"type\": \"ubyte\" },\r\n  { \"name\": \"type\", \"type\": \"ubyte\" }\r\n]]\r\n```\r\n\r\nSo it doesn't get lost in the gitter backlog.",
            "created_at": "2015-09-03T14:50:47Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/225#issuecomment-137474639",
            "id": 137474639,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/225",
            "updated_at": "2015-09-03T14:50:47Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/137474639",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2346494?v=3",
                "events_url": "https://api.github.com/users/rom1504/events{/privacy}",
                "followers_url": "https://api.github.com/users/rom1504/followers",
                "following_url": "https://api.github.com/users/rom1504/following{/other_user}",
                "gists_url": "https://api.github.com/users/rom1504/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rom1504",
                "id": 2346494,
                "login": "rom1504",
                "organizations_url": "https://api.github.com/users/rom1504/orgs",
                "received_events_url": "https://api.github.com/users/rom1504/received_events",
                "repos_url": "https://api.github.com/users/rom1504/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rom1504/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rom1504/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rom1504"
            }
        },
        {
            "body": "entity metadata is done.\r\n\r\nAny chance the new 'anon' thing can work for slot ?",
            "created_at": "2015-09-24T11:14:35Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/225#issuecomment-142900156",
            "id": 142900156,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/225",
            "updated_at": "2015-09-24T11:14:35Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/142900156",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2346494?v=3",
                "events_url": "https://api.github.com/users/rom1504/events{/privacy}",
                "followers_url": "https://api.github.com/users/rom1504/followers",
                "following_url": "https://api.github.com/users/rom1504/following{/other_user}",
                "gists_url": "https://api.github.com/users/rom1504/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rom1504",
                "id": 2346494,
                "login": "rom1504",
                "organizations_url": "https://api.github.com/users/rom1504/orgs",
                "received_events_url": "https://api.github.com/users/rom1504/received_events",
                "repos_url": "https://api.github.com/users/rom1504/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rom1504/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rom1504/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rom1504"
            }
        },
        {
            "body": "Nah, anon doesn't have much to do with it. I mean, it does allow us to have a sane object structure instead of nesting to doom, but it doesn't have any on-wire functionality.\r\n\r\nWhat we need for slot is still the same as before : a `peek` datatype. I'm very reluctant to add it though, because its semantic are not obvious at all. It's fairly obvious how all the current datatypes need to be written, peek is just downright weird.",
            "created_at": "2015-09-24T12:06:05Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/225#issuecomment-142910917",
            "id": 142910917,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/225",
            "updated_at": "2015-09-24T12:06:12Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/142910917",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1069318?v=3",
                "events_url": "https://api.github.com/users/roblabla/events{/privacy}",
                "followers_url": "https://api.github.com/users/roblabla/followers",
                "following_url": "https://api.github.com/users/roblabla/following{/other_user}",
                "gists_url": "https://api.github.com/users/roblabla/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/roblabla",
                "id": 1069318,
                "login": "roblabla",
                "organizations_url": "https://api.github.com/users/roblabla/orgs",
                "received_events_url": "https://api.github.com/users/roblabla/received_events",
                "repos_url": "https://api.github.com/users/roblabla/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/roblabla/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/roblabla/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/roblabla"
            }
        },
        {
            "body": "I think slot can be implemented without peek, it's just that nbtData will potentially be 0 which makes sense. I'll try to do that.",
            "created_at": "2015-11-09T11:29:50Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/225#issuecomment-155034371",
            "id": 155034371,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/225",
            "updated_at": "2015-11-09T11:29:50Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/155034371",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2346494?v=3",
                "events_url": "https://api.github.com/users/rom1504/events{/privacy}",
                "followers_url": "https://api.github.com/users/rom1504/followers",
                "following_url": "https://api.github.com/users/rom1504/following{/other_user}",
                "gists_url": "https://api.github.com/users/rom1504/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rom1504",
                "id": 2346494,
                "login": "rom1504",
                "organizations_url": "https://api.github.com/users/rom1504/orgs",
                "received_events_url": "https://api.github.com/users/rom1504/received_events",
                "repos_url": "https://api.github.com/users/rom1504/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rom1504/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rom1504/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rom1504"
            }
        },
        {
            "body": "So I took the same route than entityMetadata did : I defined manually a (simple) optionalNbt, that is used directly in some packets now and I used it to define slot.\r\nOnce that's merged (see https://github.com/PrismarineJS/node-minecraft-protocol/pull/304) then this issue will be mostly done (see https://github.com/roblabla/ProtoDef/issues/31 for some remaining stuff to remove from minecraft.js + maybe in the future we could make optionalNbt and entityMetadataLoop more general)\r\n\r\n",
            "created_at": "2015-11-15T17:04:13Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/225#issuecomment-156829605",
            "id": 156829605,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/225",
            "updated_at": "2015-11-15T17:04:13Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/156829605",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2346494?v=3",
                "events_url": "https://api.github.com/users/rom1504/events{/privacy}",
                "followers_url": "https://api.github.com/users/rom1504/followers",
                "following_url": "https://api.github.com/users/rom1504/following{/other_user}",
                "gists_url": "https://api.github.com/users/rom1504/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rom1504",
                "id": 2346494,
                "login": "rom1504",
                "organizations_url": "https://api.github.com/users/rom1504/orgs",
                "received_events_url": "https://api.github.com/users/rom1504/received_events",
                "repos_url": "https://api.github.com/users/rom1504/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rom1504/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rom1504/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rom1504"
            }
        },
        {
            "body": "ok, done",
            "created_at": "2015-11-19T14:13:35Z",
            "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/225#issuecomment-158069041",
            "id": 158069041,
            "issue_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/225",
            "updated_at": "2015-11-19T14:13:35Z",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/comments/158069041",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2346494?v=3",
                "events_url": "https://api.github.com/users/rom1504/events{/privacy}",
                "followers_url": "https://api.github.com/users/rom1504/followers",
                "following_url": "https://api.github.com/users/rom1504/following{/other_user}",
                "gists_url": "https://api.github.com/users/rom1504/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rom1504",
                "id": 2346494,
                "login": "rom1504",
                "organizations_url": "https://api.github.com/users/rom1504/orgs",
                "received_events_url": "https://api.github.com/users/rom1504/received_events",
                "repos_url": "https://api.github.com/users/rom1504/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rom1504/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rom1504/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rom1504"
            }
        }
    ],
    "comments": 9,
    "comments_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/225/comments",
    "created_at": "2015-08-27T13:16:38Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1069318?v=3",
                "events_url": "https://api.github.com/users/roblabla/events{/privacy}",
                "followers_url": "https://api.github.com/users/roblabla/followers",
                "following_url": "https://api.github.com/users/roblabla/following{/other_user}",
                "gists_url": "https://api.github.com/users/roblabla/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/roblabla",
                "id": 1069318,
                "login": "roblabla",
                "organizations_url": "https://api.github.com/users/roblabla/orgs",
                "received_events_url": "https://api.github.com/users/roblabla/received_events",
                "repos_url": "https://api.github.com/users/roblabla/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/roblabla/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/roblabla/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/roblabla"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2015-09-03T14:50:47Z",
            "event": "mentioned",
            "id": 400157694,
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/events/400157694"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1069318?v=3",
                "events_url": "https://api.github.com/users/roblabla/events{/privacy}",
                "followers_url": "https://api.github.com/users/roblabla/followers",
                "following_url": "https://api.github.com/users/roblabla/following{/other_user}",
                "gists_url": "https://api.github.com/users/roblabla/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/roblabla",
                "id": 1069318,
                "login": "roblabla",
                "organizations_url": "https://api.github.com/users/roblabla/orgs",
                "received_events_url": "https://api.github.com/users/roblabla/received_events",
                "repos_url": "https://api.github.com/users/roblabla/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/roblabla/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/roblabla/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/roblabla"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2015-09-03T14:50:47Z",
            "event": "subscribed",
            "id": 400157695,
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/events/400157695"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2346494?v=3",
                "events_url": "https://api.github.com/users/rom1504/events{/privacy}",
                "followers_url": "https://api.github.com/users/rom1504/followers",
                "following_url": "https://api.github.com/users/rom1504/following{/other_user}",
                "gists_url": "https://api.github.com/users/rom1504/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rom1504",
                "id": 2346494,
                "login": "rom1504",
                "organizations_url": "https://api.github.com/users/rom1504/orgs",
                "received_events_url": "https://api.github.com/users/rom1504/received_events",
                "repos_url": "https://api.github.com/users/rom1504/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rom1504/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rom1504/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rom1504"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2015-11-15T17:06:03Z",
            "event": "labeled",
            "id": 464823847,
            "label": {
                "color": "fad8c7",
                "name": "refactoring"
            },
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/events/464823847"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2346494?v=3",
                "events_url": "https://api.github.com/users/rom1504/events{/privacy}",
                "followers_url": "https://api.github.com/users/rom1504/followers",
                "following_url": "https://api.github.com/users/rom1504/following{/other_user}",
                "gists_url": "https://api.github.com/users/rom1504/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rom1504",
                "id": 2346494,
                "login": "rom1504",
                "organizations_url": "https://api.github.com/users/rom1504/orgs",
                "received_events_url": "https://api.github.com/users/rom1504/received_events",
                "repos_url": "https://api.github.com/users/rom1504/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rom1504/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rom1504/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rom1504"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2015-11-19T14:13:35Z",
            "event": "closed",
            "id": 469201474,
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/events/469201474"
        }
    ],
    "events_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/225/events",
    "html_url": "https://github.com/PrismarineJS/node-minecraft-protocol/issues/225",
    "id": 103506377,
    "labels": [
        {
            "color": "fad8c7",
            "name": "refactoring",
            "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/labels/refactoring"
        }
    ],
    "labels_url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/225/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 225,
    "state": "closed",
    "title": "Ways to phase out entityMetadata and slot datatypes",
    "updated_at": "2015-11-19T14:13:35Z",
    "url": "https://api.github.com/repos/PrismarineJS/node-minecraft-protocol/issues/225",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1069318?v=3",
        "events_url": "https://api.github.com/users/roblabla/events{/privacy}",
        "followers_url": "https://api.github.com/users/roblabla/followers",
        "following_url": "https://api.github.com/users/roblabla/following{/other_user}",
        "gists_url": "https://api.github.com/users/roblabla/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/roblabla",
        "id": 1069318,
        "login": "roblabla",
        "organizations_url": "https://api.github.com/users/roblabla/orgs",
        "received_events_url": "https://api.github.com/users/roblabla/received_events",
        "repos_url": "https://api.github.com/users/roblabla/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/roblabla/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/roblabla/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/roblabla"
    }
}